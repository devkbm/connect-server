<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.like.board.infra.mapper.BoardMapper">

    <select id="test" parameterType="map" resultType="map">
    <![CDATA[
		SELECT 1 as num 
	]]>     	  
	</select>	   
	
	<select id="getBoardListByTree" parameterType="map" resultType="map">
		SELECT A.PK_BOARD		 						AS id 		    
		     , A.BOARD_NAME								AS text
		     , IF ( B.PK_BOARD IS NULL, TRUE, FALSE)	AS leaf
		     , A.BOARD_TYPE	 							AS qtitle
		     , A.BOARD_NAME								AS qtip		     
		     , A.PPK_BOARD								AS parent_id
		     , A.FROM_DT								AS fromdd
		     , A.TO_DT									AS todd
		     , A.SEQ									AS seq
  		  FROM GRBOARD A
  	 LEFT JOIN GRBOARD AS B ON ( B.PPK_BOARD = A.PK_BOARD )
  	    WHERE A.PPK_BOARD = #{ppkboard}
	ORDER BY A.SEQ
	</select>	
	
	<select id="getArticleList" parameterType="map" resultType="com.like.board.domain.repository.dto.ArticleListDTO">
		select b.SYS_DT		as sysDt
		     , b.SYS_USER	as sysUser
		     , 'test' 		as sysUsernm
		     , b.UPD_DT  	as updDt
		     , b.UPD_USER	as updUser
		     , b.PK_ARTICLE	as pkArticle
		     , b.PPK_ARTICLE as ppkArticle
		     , b.TITLE 		as title
		     , b.CONTENTS	as contents
		     , b.PWD 		as pwd
		     , b.HIT_CNT	as hitCnt
		     , b.FROM_DT	as fromDt
		     , b.TO_DT		as toDt
		     , b.seq		as seq
		     , 'Y'			as checkYn		     
		     , case when d.PK_FILE is not null 
		            then 'Y' 
		            else 'N' 
		       end 			as fileYn
		     , ''			as fileInfo		-- uuid | path | name | size
		     , b.FK_BOARD	as fkBoard
   		  from grboard a
   			inner join grarticle b
   	        	on (a.PK_BOARD = b.FK_BOARD)
   			left outer join grarticle_files c
   	        	on (b.PK_ARTICLE = c.PK_ARTICLE)
    		left outer join cmfileinfo d
            	on (c.pk_file = d.PK_FILE)
	</select>
</mapper>